---
title: 使用 WMI 管理 Surface Dock 2
description: 本文介绍了如何使用 WMI 跨 Surface Dock 2 设备远程监视和管理最新的固件、策略状态和相关的数据。
ms.prod: w10
ms.mktglfcycl: manage
ms.localizationpriority: medium
ms.sitesec: library
author: coveminer
ms.author: greglin
ms.topic: article
ms.date: 10/12/2020
ms.reviewer: hachidan
manager: laurawi
audience: itpro
appliesto:
- Windows 10
- Windows 11
ms.openlocfilehash: 658632220dfa87aa88fa233a7d55c311042a91cc
ms.sourcegitcommit: beb2f9db90b19b74da6cdee8717cc0888f3b1d70
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/16/2022
ms.locfileid: "12448895"
---
# <a name="manage-surface-dock-2-with-wmi"></a>使用 WMI 管理 Surface Dock 2

Windows Management Instrumentation (WMI) 支持提供了一组丰富的诊断信息，使 IT 管理员能够跨 Surface Dock 2 设备远程监视和管理最新的固件、策略状态和相关的数据。 可以将 WMI 与 Windows PowerShell、System Center Operations Manager 和其他工具一同使用。 有关 WMI 的信息，请参阅 [使用 WMI](/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true)。 

若要启用 WMI 支持，请转到 [Surface Dock 2 驱动程序和固件](https://www.microsoft.com/download/details.aspx?id=101317) 并下载相应的程序包：

**SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;版本&#62;_x64.msi：**<br>

- Surface Pro (第五代及更高版本) 
- Surface Book (第二代及更高版本) 
- Surface Go (所有代) 
- Surface Laptop (所有代) 
- Surface Laptop Go

 **SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;版本&#62;_arm64.msi：** <br>

- Surface Pro X

## <a name="using-wmi-with-surface-dock-2"></a>将 WMI 与 Surface Dock 2 一同使用

1. 枚举所有扩展坞组件实例：

    ```PowerShell
    Get-CimInstance -Namespace "root/Surface" -Class "SurfaceDockComponent" 
    ```
2. 若要访问 WMI 类属性说明，请打开命令提示符并输入 WMI 命令，其中 **Property** 是表 1 中列出的属性之一。

    ```PowerShell
     Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["<Property>"]
    ```

- **示例：** 若要访问"版本通用信息**** 模型" (CIM) 的说明，请输入以下内容：
    ```PowerShell
    (Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["Version"].Qualifiers["Description"].Value
    ```
 
 ### <a name="table-1-surface-dock-2-wmi-reference"></a>表 1. Surface Dock 2 WMI 参考

| 属性         | 类型   | 预期 (值)                                                                                                                                                                                                             | 说明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ComponentName    | 字符串 | "百万年" <br>"USB Hub 1" <br>"USB Hub 2" <br>"显示端口中心" <br>"Power Delivery Controller" <br>"Audio Codec" <br>"以太网控制器"                                                                         | 以下属性列出了 CIM 中附带的通用信息模型 (类数据) 设备组件的特定名称。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| DeviceName       | 字符串 | "Surface Dock 1" <br>"Surface Dock 2"                                                                                                                                                                                        | 以下属性包含特定设备组件所属的扩展坞设备的名称。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DockSerialNumber | 字符串 | 12 (12) 只包含数值的数字序列号                                                                                                                                                           | 以下属性记录连接的扩展坞设备的序列号。 此序列号与它们属于同一扩展坞设备的每一个组件完全相同。 为参考，可以在 Surface 扩展坞本身的下面实际找到此序列号。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ID               | uint16 | 0, 1, 2, ..., 65535                                                                                                                                                                                                          | 以下属性是从零开始的唯一 ID (0) 计数。 此变量用于对枚举的 WMI 实例进行编号。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| LastUpdateStatus | 字符串 | "Success" <br>"PendingDockReattach" <br>"Failed"                                                                                                                                                                             | 以下属性详细说明了上一次尝试的组件固件更新 (CFU) 设备组件的状态。 可能的值包括：**Success、****Pending Dock Reattach 和** **Failed。**<br><br><br>- **成功** 表示已成功应用以前应用的新固件<br>- **Pending Dock Reattach** 指示设备组件有新的更新挂起，并且用户必须分离和重新连接扩展坞的 Surface 连接器才能应用新更新。<br>- **失败** 表示 CFU 进程期间发生可能的合法错误，或者外设未在预期版本中启动。 在 **"失败** "情况下，这不是设备未正常工作的指示，而是尝试更新设备时发生了错误。 在这种情况下，以前的固件将继续运行。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| PolicyState      | 字符串 | "Enabled" <br>"Disabled"                                                                                                                                                                                                     | 以下属性指示设备组件的当前 Surface Enterprise管理 (SEMM) 策略。 可能的值是： **Enabled** 和 **Disabled。**<br><br><br>- **Enabled** 指示 SEMM 系统已允许主机设备访问和使用设备组件<br>- **Disabled** 指示 SEMM 系统已不允许，因此阻止主机访问和使用设备组件。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProductId        | String[] | 十六进制字符串的列表，每个范围从"0x0000"到"0xFFFF"                                                                                                                                                        | 以下属性对设备组件 (PID) 产品 ID 分类。 可以列出多个 PID。 例如，对于 USB 集线器，超级速度 (SS) 和高速 (HS) 设备都分为一个单数"中心"。 因此， (2) 个 2 个 PID 将在此数组中列出。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProvisionedState         | 布尔型 | True 或 False                                                                                                                                                        | 以下属性介绍了 Surface Enterprise 管理 (SEMM) Surface 扩展坞设备的预配状态。 每个组件的预配状态与它们属于同一扩展坞设备时完全相同。 可能的值是：True 或 False。 true 值表示 Surface 扩展坞设备当前受管理，因此端口功能可能会受到限制。 有关详细信息，请参阅"PolicyState"属性字段。 false 值表示 Surface 扩展坞设备当前未进行管理，并且没有任何功能限制。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 状态           | 字符串 | "OK" <br>"Disconnected" <br>"Error" <br>"Missing" <br>"DeviceHandleInUse" <br>"Disabled" <br>"NotSupportedByWmi"                                                                                                             | 以下属性描述扩展坞与主机的连接状态。 可能的值包括：**OK**、**Disconnected**、**Error、****Missing、****DeviceHandleInUse、****Disabled** 和 **NotSupportedByWmi。**   <br>- **OK** 指示设备已成功连接到主机，并且不存在问题，这将限制其功能 <br>- **Disconnected** 表示 Surface 连接器（提供所有设备组件的连接）当前未连接到主机。 <br>- **** 错误指示设备实例的潜在问题，设备接口很可能在设备管理器中标有黄色感叹号 – 检查 **StatusCode** 属性，了解有关发生的错误类型的更多详细信息。 <br>- **缺少** 指示设备预期已枚举在主机上，但因某种原因未枚举。 **StatusCode** 属性将保留值 24 以指示此错误情况。<br>- **DeviceHandleInUse** 指示另一个进程当前正在与设备通信，这将禁止此 Windows Management Instrumentation (WMI) 实例提供程序进行通信请求。 请尝试再次执行 WMI 命令！ <br> - **Disabled** 指示当前 Surface Enterprise 管理模式 (SEMM) 策略已禁止，从而阻止主机访问和使用设备组件。 有关详细信息， **请参阅 PolicyState** 属性字段。<br>- **NotSupportedByWmi** 指示连接的扩展坞当前不受此 WMI 提供程序支持。 Surface Dock 1 将显示此状态，此 WMI 实例提供程序当前不支持此状态。|
| StatusCode       | uint32 | [从](/windows-hardware/drivers/install/device-manager-error-messages) *cimwin32.mof* CIM_LogicalDevice中的 WMI 类 (获取的设备管理器错误)  | 以下属性为给定的扩展坞组件提供设备管理器错误代码。 值 0 (0) 表示扩展坞组件正常工作;值大于 0 (0) 指示扩展坞组件存在问题或可能的错误。 由于扩展坞组件可能枚举多个设备接口，因此可能有其他设备管理器错误代码。 此属性字段仅列出单个错误代码（即使多个错误代码可用）。 设备管理器仅在出现某些错误代码时，才将设备标记为黄色感叹号。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| VendorId         | 字符串 | 一个十六进制字符串，范围从"0x0000"到"0xFFFF"                                                                                                                                                                        | 以下属性将记下设备组件 (VID) 特定供应商 ID。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 版本          | 字符串 | 一个版本字符串，其格式如下："x.y.z"，其中 x、y 和 z 是数值。                                                                                                                            | 以下属性指定当前版本的固件，该固件当前在设备组件上运行。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |


## <a name="learn-more"></a>了解详细信息

- [使用 SEMM 保护 Surface Dock 2 端口](secure-surface-dock-ports-semm.md)
- [Surface Dock 2 的新增功能](surface-dock-whats-new.md)
- [设备管理器错误代码](/windows-hardware/drivers/install/device-manager-error-messages)
- [使用 WMI](/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true)
